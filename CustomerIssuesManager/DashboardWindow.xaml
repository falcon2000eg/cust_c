<Window x:Class="CustomerIssuesManager.DashboardWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… - Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ù…Ø´Ø§ÙƒÙ„ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡" 
        Height="800" Width="1200"
        WindowStartupLocation="CenterScreen"
        FlowDirection="RightToLeft"
        Background="#f8f9fa">
    
    <Window.Resources>
        <!-- Colors -->
        <SolidColorBrush x:Key="BgMain" Color="#f8f9fa"/>
        <SolidColorBrush x:Key="BgCard" Color="#f0f6fa"/>
        <SolidColorBrush x:Key="BgLight" Color="#ffffff"/>
        <SolidColorBrush x:Key="Header" Color="#2c3e50"/>
        <SolidColorBrush x:Key="HeaderText" Color="White"/>
        <SolidColorBrush x:Key="ButtonSave" Color="#27ae60"/>
        <SolidColorBrush x:Key="ButtonDelete" Color="#e74c3c"/>
        <SolidColorBrush x:Key="ButtonAction" Color="#3498db"/>
        <SolidColorBrush x:Key="ButtonSecondary" Color="#95a5a6"/>
        <SolidColorBrush x:Key="ButtonWarning" Color="#f39c12"/>
        <SolidColorBrush x:Key="TextMain" Color="#222"/>
        <SolidColorBrush x:Key="TextSubtle" Color="#7f8c8d"/>
        <SolidColorBrush x:Key="BorderLight" Color="#e0e0e0"/>
        <SolidColorBrush x:Key="Success" Color="#27ae60"/>
        <SolidColorBrush x:Key="Warning" Color="#f39c12"/>
        <SolidColorBrush x:Key="Error" Color="#e74c3c"/>
        <SolidColorBrush x:Key="Info" Color="#3498db"/>
        
        <!-- Styles -->
        <Style x:Key="HeaderTextStyle" TargetType="TextBlock">
            <Setter Property="FontFamily" Value="Arial"/>
            <Setter Property="FontSize" Value="24"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="Foreground" Value="{StaticResource HeaderText}"/>
        </Style>
        
        <Style x:Key="CardStyle" TargetType="Border">
            <Setter Property="Background" Value="{StaticResource BgLight}"/>
            <Setter Property="CornerRadius" Value="8"/>
            <Setter Property="BorderBrush" Value="{StaticResource BorderLight}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Padding" Value="20"/>
            <Setter Property="Margin" Value="10"/>
        </Style>
        
        <Style x:Key="StatCardStyle" TargetType="Border">
            <Setter Property="Background" Value="{StaticResource BgLight}"/>
            <Setter Property="CornerRadius" Value="8"/>
            <Setter Property="BorderBrush" Value="{StaticResource BorderLight}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Padding" Value="15"/>
            <Setter Property="Margin" Value="5"/>
        </Style>
        
        <Style x:Key="ButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="{StaticResource ButtonAction}"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="Padding" Value="15,8"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}" 
                                CornerRadius="4" 
                                Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#2980b9"/>
                </Trigger>
            </Style.Triggers>
        </Style>
        
        <!-- DataGrid Style -->
        <Style x:Key="DashboardDataGridStyle" TargetType="DataGrid">
            <Setter Property="Background" Value="{StaticResource BgLight}"/>
            <Setter Property="BorderBrush" Value="{StaticResource BorderLight}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="GridLinesVisibility" Value="Horizontal"/>
            <Setter Property="HorizontalGridLinesBrush" Value="{StaticResource BorderLight}"/>
            <Setter Property="RowBackground" Value="{StaticResource BgLight}"/>
            <Setter Property="AlternatingRowBackground" Value="{StaticResource BgCard}"/>
            <Setter Property="HeadersVisibility" Value="Column"/>
            <Setter Property="CanUserAddRows" Value="False"/>
            <Setter Property="CanUserDeleteRows" Value="False"/>
            <Setter Property="CanUserResizeRows" Value="False"/>
            <Setter Property="CanUserResizeColumns" Value="True"/>
            <Setter Property="CanUserSortColumns" Value="True"/>
            <Setter Property="AutoGenerateColumns" Value="False"/>
            <Setter Property="SelectionMode" Value="Single"/>
            <Setter Property="SelectionUnit" Value="FullRow"/>
        </Style>
    </Window.Resources>
    
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>
        
        <!-- Header -->
        <Border Grid.Row="0" Background="{StaticResource Header}" Padding="20">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                
                <StackPanel Grid.Column="0">
                    <TextBlock Text="Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…" Style="{StaticResource HeaderTextStyle}"/>
                    <TextBlock Text="Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ù…Ø´Ø§ÙƒÙ„ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡" Foreground="{StaticResource TextSubtle}" FontSize="14"/>
                </StackPanel>
                
                <StackPanel Grid.Column="1" Orientation="Horizontal">
                    <Button Content="ðŸ“‹ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø´Ø§ÙƒÙ„" Click="OpenCasesManagement_Click" Style="{StaticResource ButtonStyle}" Margin="5"/>
                    <Button Content="ðŸ” Ø§Ù„Ø¨Ø­Ø« Ø§Ù„Ù…ØªÙ‚Ø¯Ù…" Click="OpenAdvancedSearch_Click" Style="{StaticResource ButtonStyle}" Margin="5"/>
                    <Button Content="ðŸ‘¥ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†" Click="OpenEmployeeManagement_Click" Style="{StaticResource ButtonStyle}" Margin="5"/>
                    <Button Content="âš™ï¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª" Click="OpenSettings_Click" Style="{StaticResource ButtonStyle}" Margin="5"/>
                    <Button Content=" ØªØ­Ø¯ÙŠØ«" Click="RefreshStatistics_Click" Style="{StaticResource ButtonStyle}" Margin="5"/>
                    <Button Content="â“ Ù…Ø³Ø§Ø¹Ø¯Ø©" Click="Help_Click" Style="{StaticResource ButtonStyle}" Margin="5"/>
                    <Button Content="â„¹ï¸ Ø­ÙˆÙ„" Click="About_Click" Style="{StaticResource ButtonStyle}" Margin="5"/>
                </StackPanel>
            </Grid>
        </Border>
        
        <!-- Main Content -->
        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
            <StackPanel Margin="20">
                <!-- Statistics Cards -->
                <TextBlock Text="ðŸ“Š Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø¹Ø§Ù…Ø©" FontSize="20" FontWeight="Bold" Margin="0,0,0,20"/>
                
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    
                    <!-- Total Cases -->
                    <Border Grid.Column="0" Style="{StaticResource StatCardStyle}">
                        <StackPanel>
                            <TextBlock Text="Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø´Ø§ÙƒÙ„" FontWeight="Bold" FontSize="16"/>
                            <TextBlock x:Name="TotalCasesLabel" Text="0" FontSize="24" Foreground="{StaticResource Info}"/>
                        </StackPanel>
                    </Border>
                    
                    <!-- New Cases -->
                    <Border Grid.Column="1" Style="{StaticResource StatCardStyle}">
                        <StackPanel>
                            <TextBlock Text="Ø§Ù„Ù…Ø´Ø§ÙƒÙ„ Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©" FontWeight="Bold" FontSize="16"/>
                            <TextBlock x:Name="NewCasesLabel" Text="0" FontSize="24" Foreground="{StaticResource Info}"/>
                            <ProgressBar x:Name="NewCasesProgressBar" Height="4" Margin="0,5,0,0"/>
                        </StackPanel>
                    </Border>
                    
                    <!-- In Progress -->
                    <Border Grid.Column="2" Style="{StaticResource StatCardStyle}">
                        <StackPanel>
                            <TextBlock Text="Ù‚ÙŠØ¯ Ø§Ù„ØªÙ†ÙÙŠØ°" FontWeight="Bold" FontSize="16"/>
                            <TextBlock x:Name="InProgressLabel" Text="0" FontSize="24" Foreground="{StaticResource Warning}"/>
                            <ProgressBar x:Name="InProgressProgressBar" Height="4" Margin="0,5,0,0"/>
                        </StackPanel>
                    </Border>
                    
                    <!-- Solved -->
                    <Border Grid.Column="3" Style="{StaticResource StatCardStyle}">
                        <StackPanel>
                            <TextBlock Text="ØªÙ… Ø­Ù„Ù‡Ø§" FontWeight="Bold" FontSize="16"/>
                            <TextBlock x:Name="SolvedLabel" Text="0" FontSize="24" Foreground="{StaticResource Success}"/>
                            <ProgressBar x:Name="SolvedProgressBar" Height="4" Margin="0,5,0,0"/>
                        </StackPanel>
                    </Border>
                </Grid>
                
                <!-- Additional Statistics -->
                <Grid Margin="0,20,0,0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    
                    <!-- Closed Cases -->
                    <Border Grid.Column="0" Style="{StaticResource StatCardStyle}">
                        <StackPanel>
                            <TextBlock Text="Ù…ØºÙ„Ù‚Ø©" FontWeight="Bold" FontSize="16"/>
                            <TextBlock x:Name="ClosedLabel" Text="0" FontSize="24" Foreground="{StaticResource TextSubtle}"/>
                            <ProgressBar x:Name="ClosedProgressBar" Height="4" Margin="0,5,0,0"/>
                        </StackPanel>
                    </Border>
                    
                    <!-- Active Cases -->
                    <Border Grid.Column="1" Style="{StaticResource StatCardStyle}">
                        <StackPanel>
                            <TextBlock Text="Ø§Ù„Ù…Ø´Ø§ÙƒÙ„ Ø§Ù„Ù†Ø´Ø·Ø©" FontWeight="Bold" FontSize="16"/>
                            <TextBlock x:Name="ActiveCasesLabel" Text="0" FontSize="24" Foreground="{StaticResource Warning}"/>
                        </StackPanel>
                    </Border>
                    
                    <!-- This Month -->
                    <Border Grid.Column="2" Style="{StaticResource StatCardStyle}">
                        <StackPanel>
                            <TextBlock Text="Ù‡Ø°Ø§ Ø§Ù„Ø´Ù‡Ø±" FontWeight="Bold" FontSize="16"/>
                            <TextBlock x:Name="CasesThisMonthLabel" Text="0" FontSize="24" Foreground="{StaticResource Info}"/>
                        </StackPanel>
                    </Border>
                    
                    <!-- This Year -->
                    <Border Grid.Column="3" Style="{StaticResource StatCardStyle}">
                        <StackPanel>
                            <TextBlock Text="Ù‡Ø°Ø§ Ø§Ù„Ø¹Ø§Ù…" FontWeight="Bold" FontSize="16"/>
                            <TextBlock x:Name="CasesThisYearLabel" Text="0" FontSize="24" Foreground="{StaticResource Info}"/>
                        </StackPanel>
                    </Border>
                </Grid>
                
                <!-- Detailed Information -->
                <TextBlock Text="ðŸ“ˆ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª ØªÙØµÙŠÙ„ÙŠØ©" FontSize="20" FontWeight="Bold" Margin="0,30,0,20"/>
                
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    
                    <Border Grid.Column="0" Style="{StaticResource CardStyle}">
                        <StackPanel>
                            <TextBlock Text="Ø§Ù„Ù…Ø±ÙÙ‚Ø§Øª ÙˆØ§Ù„Ù…Ø±Ø§Ø³Ù„Ø§Øª" FontWeight="Bold" FontSize="16" Margin="0,0,0,15"/>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <StackPanel Grid.Column="0">
                                    <TextBlock Text="Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø±ÙÙ‚Ø§Øª" FontSize="14"/>
                                    <TextBlock x:Name="TotalAttachmentsLabel" Text="0" FontSize="20" Foreground="{StaticResource Info}"/>
                                </StackPanel>
                                <StackPanel Grid.Column="1">
                                    <TextBlock Text="Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø±Ø§Ø³Ù„Ø§Øª" FontSize="14"/>
                                    <TextBlock x:Name="TotalCorrespondencesLabel" Text="0" FontSize="20" Foreground="{StaticResource Info}"/>
                                </StackPanel>
                            </Grid>
                        </StackPanel>
                    </Border>
                    
                    <Border Grid.Column="1" Style="{StaticResource CardStyle}">
                        <StackPanel>
                            <TextBlock Text="Ø§Ù„Ù…Ø¤Ø´Ø±Ø§Øª" FontWeight="Bold" FontSize="16" Margin="0,0,0,15"/>
                            <StackPanel>
                                <TextBlock Text="Ù…ØªÙˆØ³Ø· ÙˆÙ‚Øª Ø§Ù„Ø­Ù„:" FontSize="14"/>
                                <TextBlock x:Name="AverageResolutionTimeLabel" Text="ØºÙŠØ± Ù…ØªÙˆÙØ±" FontSize="16" Foreground="{StaticResource Success}"/>
                            </StackPanel>
                            <StackPanel Margin="0,10,0,0">
                                <TextBlock Text="Ø§Ù„ØªØµÙ†ÙŠÙ Ø§Ù„Ø£ÙƒØ«Ø± Ø´ÙŠÙˆØ¹Ø§Ù‹:" FontSize="14"/>
                                <TextBlock x:Name="MostCommonCategoryLabel" Text="ØºÙŠØ± Ù…ØªÙˆÙØ±" FontSize="16" Foreground="{StaticResource Info}"/>
                            </StackPanel>
                            <StackPanel Margin="0,10,0,0">
                                <TextBlock Text="Ø§Ù„Ù…ÙˆØ¸Ù Ø§Ù„Ø£ÙƒØ«Ø± Ù†Ø´Ø§Ø·Ø§Ù‹:" FontSize="14"/>
                                <TextBlock x:Name="MostActiveEmployeeLabel" Text="ØºÙŠØ± Ù…ØªÙˆÙØ±" FontSize="16" Foreground="{StaticResource Info}"/>
                            </StackPanel>
                            <StackPanel Margin="0,10,0,0">
                                <TextBlock Text="Ø¢Ø®Ø± Ù…Ø´ÙƒÙ„Ø©:" FontSize="14"/>
                                <TextBlock x:Name="LastCaseDateLabel" Text="ØºÙŠØ± Ù…ØªÙˆÙØ±" FontSize="16" Foreground="{StaticResource TextSubtle}"/>
                            </StackPanel>
                        </StackPanel>
                    </Border>
                </Grid>
                
                <!-- Active Cases Table -->
                <TextBlock Text="ðŸ“‹ Ø§Ù„Ù…Ø´Ø§ÙƒÙ„ Ø§Ù„Ù†Ø´Ø·Ø©" FontSize="20" FontWeight="Bold" Margin="0,30,0,20"/>
                
                <Border Style="{StaticResource CardStyle}">
                    <StackPanel>
                        <TextBlock Text="Ø§Ù„Ù…Ø´Ø§ÙƒÙ„ Ø§Ù„ØªÙŠ Ù„Ù… ÙŠØªÙ… Ø­Ù„Ù‡Ø§ Ø£Ùˆ Ø¥ØºÙ„Ø§Ù‚Ù‡Ø§" FontSize="14" Foreground="{StaticResource TextSubtle}" Margin="0,0,0,15"/>
                        <DataGrid x:Name="ActiveCasesDataGrid" 
                                  Style="{StaticResource DashboardDataGridStyle}"
                                  Height="300"
                                  IsReadOnly="True"
                                  SelectionMode="Single"
                                  AutoGenerateColumns="False">
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„" Binding="{Binding CustomerName}" Width="200"/>
                                <DataGridTextColumn Header="Ø±Ù‚Ù… Ø§Ù„Ù…Ø´ØªØ±Ùƒ" Binding="{Binding SubscriberNumber}" Width="150"/>
                                <DataGridTextColumn Header="ØªØµÙ†ÙŠÙ Ø§Ù„Ù…Ø´ÙƒÙ„Ø©" Binding="{Binding Category.CategoryName}" Width="150"/>
                                <DataGridTextColumn Header="Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø´ÙƒÙ„Ø©" Binding="{Binding Status}" Width="120"/>
                                <DataGridTextColumn Header="ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥Ø¶Ø§ÙØ©" Binding="{Binding CreatedDate, StringFormat=yyyy/MM/dd}" Width="120"/>
                                <DataGridTextColumn Header="Ø£Ù†Ø´Ø¦ Ø¨ÙˆØ§Ø³Ø·Ø©" Binding="{Binding CreatedBy.Name}" Width="150"/>
                            </DataGrid.Columns>
                        </DataGrid>
                    </StackPanel>
                </Border>
                
            </StackPanel>
        </ScrollViewer>
    </Grid>
</Window>